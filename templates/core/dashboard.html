{% extends 'base.html' %}

{% block title %}–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - –ó–æ–æ–ë–æ–∑–æ—Ä{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
        <div>
            <h1 class="text-4xl font-bold gold-text mb-2">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
            <p class="text-gray-400">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏</p>
        </div>
        <a href="{% url 'add_animal' %}" class="px-6 py-3 bg-gradient-to-r from-[#D4AF37] to-[#FFD700] text-black font-bold rounded-lg hover:from-[#FFD700] hover:to-[#D4AF37] transition-all duration-300 shadow-lg">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
        </a>
    </div>

    <!-- Verification Notice -->
    {% if show_verification_notice %}
    <div class="mb-8 bg-gradient-to-r from-blue-900/20 to-purple-900/20 border-2 border-blue-500 rounded-xl p-6 relative overflow-hidden">
        <div class="absolute top-0 right-0 text-9xl opacity-10">‚úì</div>
        <div class="relative z-10">
            <div class="flex items-start gap-4">
                <div class="text-5xl">üéâ</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-blue-400 mb-2">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã —É—Å–ø–µ—à–Ω—ã–π –ø—Ä–æ–¥–∞–≤–µ—Ü!</h3>
                    <p class="text-gray-300 mb-4">
                        –í—ã –ø—Ä–æ–¥–∞–ª–∏ <span class="text-[#D4AF37] font-bold">{{ sold_animals }}</span> —Ç–æ–≤–∞—Ä–æ–≤. 
                        –ü–æ–ª—É—á–∏—Ç–µ <span class="text-blue-400 font-bold">–°–∏–Ω—é—é –ì–∞–ª–æ—á–∫—É</span> –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞!
                    </p>
                    <a href="https://t.me/Magasah" target="_blank" class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-lg">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18 1.897-.962 6.502-1.359 8.627-.168.9-.5 1.201-.82 1.23-.697.064-1.226-.461-1.901-.903-1.056-.693-1.653-1.124-2.678-1.8-1.185-.781-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.139-5.062 3.345-.479.329-.913.489-1.302.481-.428-.009-1.252-.241-1.865-.44-.752-.244-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.831-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635.099-.002.321.023.465.139.121.098.155.23.171.324.016.094.036.308.02.475z"/>
                        </svg>
                        –°–≤—è–∑–∞—Ç—å—Å—è —Å –ê–¥–º–∏–Ω–æ–º
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Statistics -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <div class="bg-[#1E1E1E] rounded-xl p-6 border-2 border-[#D4AF37]/30">
            <div class="text-3xl mb-2">üìä</div>
            <div class="text-3xl font-bold gold-text">{{ total_animals }}</div>
            <div class="text-gray-400 text-sm">–í—Å–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</div>
        </div>
        
        <div class="bg-[#1E1E1E] rounded-xl p-6 border-2 border-green-500/30">
            <div class="text-3xl mb-2">‚úÖ</div>
            <div class="text-3xl font-bold text-green-400">{{ active_animals }}</div>
            <div class="text-gray-400 text-sm">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
        </div>
        
        <div class="bg-[#1E1E1E] rounded-xl p-6 border-2 border-blue-500/30">
            <div class="text-3xl mb-2">üí∞</div>
            <div class="text-3xl font-bold text-blue-400">{{ sold_animals }}</div>
            <div class="text-gray-400 text-sm">–ü—Ä–æ–¥–∞–Ω–æ</div>
        </div>
        
        <div class="bg-[#1E1E1E] rounded-xl p-6 border-2 border-pink-500/30">
            <div class="text-3xl mb-2">‚ù§Ô∏è</div>
            <div class="text-3xl font-bold text-pink-400">{{ favorites_count }}</div>
            <div class="text-gray-400 text-sm">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</div>
        </div>
    </div>

    <!-- Tabs -->
    <div class="flex flex-wrap gap-2 mb-6 border-b-2 border-gray-800 pb-4">
        <a href="?status=active" class="px-6 py-3 rounded-lg font-semibold transition {% if status_filter == 'active' %}bg-[#D4AF37] text-black{% else %}text-gray-400 hover:text-[#D4AF37]{% endif %}">
            ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ ({{ active_animals }})
        </a>
        <a href="?status=sold" class="px-6 py-3 rounded-lg font-semibold transition {% if status_filter == 'sold' %}bg-[#D4AF37] text-black{% else %}text-gray-400 hover:text-[#D4AF37]{% endif %}">
            üí∞ –ü—Ä–æ–¥–∞–Ω–Ω—ã–µ ({{ sold_animals }})
        </a>
        <a href="?status=archived" class="px-6 py-3 rounded-lg font-semibold transition {% if status_filter == 'archived' %}bg-[#D4AF37] text-black{% else %}text-gray-400 hover:text-[#D4AF37]{% endif %}">
            üì¶ –ê—Ä—Ö–∏–≤
        </a>
        <a href="?status=favorite" class="px-6 py-3 rounded-lg font-semibold transition {% if status_filter == 'favorite' %}bg-[#D4AF37] text-black{% else %}text-gray-400 hover:text-[#D4AF37]{% endif %}">
            ‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ ({{ favorites_count }})
        </a>
    </div>

    <!-- Animals Grid -->
    {% if animals %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for animal in animals %}
        <div class="bg-[#1E1E1E] rounded-xl overflow-hidden border-2 {% if animal.is_vip %}border-[#D4AF37]{% else %}border-gray-800{% endif %} hover:border-[#D4AF37] transition">
            <!-- Image -->
            <div class="relative aspect-[4/3]">
                <img src="{{ animal.main_photo.url }}" alt="{{ animal.title }}" class="w-full h-full object-cover">
                {% if animal.is_vip %}
                <div class="absolute top-2 left-2 bg-gradient-to-r from-[#D4AF37] to-[#FFD700] text-black px-3 py-1 rounded-lg font-bold text-xs">
                    üëë VIP
                </div>
                {% endif %}
                {% if animal.status == 'sold' %}
                <div class="absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded-lg font-bold text-xs">
                    ‚úì –ü–†–û–î–ê–ù–û
                </div>
                {% endif %}
            </div>
            
            <!-- Content -->
            <div class="p-4">
                <h3 class="text-lg font-bold text-white mb-2 line-clamp-2">{{ animal.title }}</h3>
                <div class="text-2xl font-bold gold-text mb-3">{{ animal.price|floatformat:0 }} TJS</div>
                
                <!-- Stats -->
                <div class="flex items-center gap-4 text-sm text-gray-400 mb-4">
                    <span class="flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                        </svg>
                        {{ animal.views_count }}
                    </span>
                    <span class="flex items-center gap-1">
                        ‚ù§Ô∏è {{ animal.favorites.count }}
                    </span>
                </div>
                
                <!-- Actions -->
                <div class="flex flex-wrap gap-2">
                    <a href="{% url 'animal_detail' animal.pk %}" class="flex-1 text-center px-3 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition text-sm">
                        üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                    </a>
                    <a href="{% url 'edit_animal' animal.pk %}" class="flex-1 text-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </a>
                </div>
                
                {% if animal.status == 'active' %}
                <div class="flex gap-2 mt-2">
                    <form method="post" action="{% url 'mark_as_sold' animal.pk %}" class="flex-1">
                        {% csrf_token %}
                        <button type="submit" class="w-full px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm font-semibold">
                            ‚úì –ü—Ä–æ–¥–∞–Ω–æ
                        </button>
                    </form>
                    <form method="post" action="{% url 'delete_animal' animal.pk %}" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?')" class="flex-1">
                        {% csrf_token %}
                        <button type="submit" class="w-full px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm font-semibold">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if animals.has_other_pages %}
    <div class="flex justify-center items-center gap-2 mt-8">
        {% if animals.has_previous %}
        <a href="?status={{ status_filter }}&page={{ animals.previous_page_number }}" class="px-4 py-2 bg-[#1E1E1E] border-2 border-[#D4AF37] text-[#D4AF37] rounded-lg hover:bg-[#D4AF37] hover:text-black transition">
            ‚Üê –ù–∞–∑–∞–¥
        </a>
        {% endif %}
        
        <span class="px-4 py-2 text-gray-400">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ animals.number }} –∏–∑ {{ animals.paginator.num_pages }}
        </span>
        
        {% if animals.has_next %}
        <a href="?status={{ status_filter }}&page={{ animals.next_page_number }}" class="px-4 py-2 bg-[#1E1E1E] border-2 border-[#D4AF37] text-[#D4AF37] rounded-lg hover:bg-[#D4AF37] hover:text-black transition">
            –í–ø–µ—Ä–µ–¥ ‚Üí
        </a>
        {% endif %}
    </div>
    {% endif %}
    
    {% else %}
    <div class="text-center py-16">
        <div class="text-6xl mb-4">üì≠</div>
        <h3 class="text-2xl font-bold text-gray-400 mb-2">
            {% if status_filter == 'sold' %}
            –ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
            {% elif status_filter == 'archived' %}
            –ê—Ä—Ö–∏–≤ –ø—É—Å—Ç
            {% elif status_filter == 'favorite' %}
            –ò–∑–±—Ä–∞–Ω–Ω–æ–µ –ø—É—Å—Ç–æ
            {% else %}
            –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
            {% endif %}
        </h3>
        <p class="text-gray-500 mb-6">–ù–∞—á–Ω–∏—Ç–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!</p>
        <a href="{% url 'add_animal' %}" class="inline-block px-8 py-4 bg-gradient-to-r from-[#D4AF37] to-[#FFD700] text-black font-bold rounded-xl hover:from-[#FFD700] hover:to-[#D4AF37] transition-all duration-300 shadow-lg">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
