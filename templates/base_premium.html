<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>{% block title %}–ì–æ–ª—É–±–ë–æ–∑–æ—Ä - –ü—Ä–µ–º–∏—É–º —Ä—ã–Ω–æ–∫ –≥–æ–ª—É–±–µ–π –¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω–∞{% endblock %}</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- AOS (Animate On Scroll) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- SimpleLightbox -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.14.2/simple-lightbox.min.css" />
    
    <!-- Custom CSS -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
        }
        .gold-text {
            color: #D4AF37;
        }
        .gold-border {
            border-color: #D4AF37;
        }
        .gold-bg {
            background-color: #D4AF37;
        }
        
        /* Winter Garland */
        body.winter-mode::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, 
                #ff0000 0%, #00ff00 20%, #0000ff 40%, 
                #ffff00 60%, #ff00ff 80%, #00ffff 100%);
            background-size: 200% 100%;
            animation: garland 3s linear infinite;
            z-index: 9999;
            pointer-events: none;
        }
        
        @keyframes garland {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }
        
        /* Mobile menu transition */
        #mobile-menu {
            transition: transform 0.3s ease-in-out;
        }
        
        /* Bottom padding for mobile nav */
        @media (max-width: 1023px) {
            main {
                padding-bottom: 5rem;
            }
        }
    </style>
</head>
<body class="bg-[#121212] text-gray-200 min-h-screen" data-user-authenticated="{% if user.is_authenticated %}true{% else %}false{% endif %}">
    
    <!-- Snow Container (Winter Mode) -->
    <div id="snow-container" class="fixed inset-0 pointer-events-none z-snow"></div>
    
    <!-- Mobile Menu Overlay -->
    <div id="menu-overlay" class="fixed inset-0 bg-black/50 z-overlay hidden lg:hidden"></div>
    
    <!-- Mobile Menu Sidebar -->
    <div id="mobile-menu" class="fixed top-0 left-0 h-full w-80 bg-[#1E1E1E] border-r border-gray-800 z-modal -translate-x-full lg:hidden overflow-y-auto">
        <div class="p-6">
            <!-- Close Button -->
            <div class="flex justify-between items-center mb-8">
                <div class="flex items-center space-x-2">
                    <span class="text-2xl">üïäÔ∏è</span>
                    <span class="text-2xl font-bold gold-text">–ì–æ–ª—É–±–ë–æ–∑–æ—Ä</span>
                </div>
                <button id="mobile-menu-close" onclick="document.getElementById('mobile-menu-btn').click()" class="text-gray-400 hover:text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <!-- Mobile Menu Links -->
            <nav class="space-y-4">
                {% if user.is_authenticated %}
                    <a href="{% url 'home' %}" class="block px-4 py-3 rounded-lg text-gray-300 hover:bg-[#2A2A2A] hover:text-[#D4AF37] transition">
                        <span class="text-xl mr-2">üè†</span> –ì–ª–∞–≤–Ω–∞—è
                    </a>
                    <a href="{% url 'add_pigeon' %}" class="block px-4 py-3 rounded-lg bg-[#D4AF37] text-black font-semibold hover:bg-[#C5A028] transition">
                        <span class="text-xl mr-2">‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                    </a>
                    <a href="{% url 'my_pigeons' %}" class="block px-4 py-3 rounded-lg text-gray-300 hover:bg-[#2A2A2A] hover:text-[#D4AF37] transition">
                        <span class="text-xl mr-2">üìã</span> –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
                    </a>
                    <a href="{% url 'vip_payment' %}" class="block px-4 py-3 rounded-lg text-gray-300 hover:bg-[#2A2A2A] hover:text-[#D4AF37] transition">
                        <span class="text-xl mr-2">‚≠ê</span> VIP —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
                    </a>
                    
                    <div class="border-t border-gray-700 my-4"></div>
                    
                    <div class="px-4 py-2 text-sm text-gray-500">
                        –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ <span class="text-[#D4AF37] font-semibold">{{ user.username }}</span>
                    </div>
                    
                    <form method="post" action="{% url 'logout' %}" class="block">
                        {% csrf_token %}
                        <button type="submit" class="w-full text-left px-4 py-3 rounded-lg text-gray-300 hover:bg-[#2A2A2A] hover:text-red-500 transition">
                            <span class="text-xl mr-2">üö™</span> –í—ã—Ö–æ–¥
                        </button>
                    </form>
                {% else %}
                    <a href="{% url 'home' %}" class="block px-4 py-3 rounded-lg text-gray-300 hover:bg-[#2A2A2A] hover:text-[#D4AF37] transition">
                        <span class="text-xl mr-2">üè†</span> –ì–ª–∞–≤–Ω–∞—è
                    </a>
                    <a href="{% url 'login' %}" class="block px-4 py-3 rounded-lg text-gray-300 hover:bg-[#2A2A2A] hover:text-[#D4AF37] transition">
                        <span class="text-xl mr-2">üîê</span> –í—Ö–æ–¥
                    </a>
                    <a href="{% url 'register' %}" class="block px-4 py-3 rounded-lg border-2 border-[#D4AF37] text-[#D4AF37] font-semibold hover:bg-[#D4AF37] hover:text-black transition text-center">
                        <span class="text-xl mr-2">üìù</span> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                    </a>
                {% endif %}
            </nav>
        </div>
    </div>
    
    <!-- Top Navigation Bar -->
    <nav class="bg-[#1E1E1E] border-b border-gray-800 sticky top-0 z-nav">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Mobile Menu Button (Mobile Only) -->
                <button id="mobile-menu-btn" class="lg:hidden text-gray-300 hover:text-[#D4AF37] transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                
                <!-- Logo -->
                <a href="{% url 'home' %}" class="flex items-center space-x-2">
                    <span class="text-2xl">üïäÔ∏è</span>
                    <span class="text-xl md:text-2xl font-bold gold-text">–ì–æ–ª—É–±–ë–æ–∑–æ—Ä</span>
                </a>
                
                <!-- Search Bar (Desktop Only) -->
                <div class="hidden lg:block flex-1 max-w-md mx-8">
                    <form action="{% url 'home' %}" method="get" class="relative">
                        <input 
                            type="text" 
                            name="search" 
                            placeholder="–ü–æ–∏—Å–∫ –≥–æ–ª—É–±–µ–π..."
                            value="{{ search_query|default:'' }}"
                            class="w-full px-4 py-2 bg-[#121212] border border-gray-700 rounded-lg text-gray-200 focus:border-[#D4AF37] focus:outline-none"
                        >
                        <button type="submit" class="absolute right-3 top-2.5 text-[#D4AF37]">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </button>
                    </form>
                </div>
                
                <!-- Desktop Navigation Links (Desktop Only) -->
                <div class="hidden lg:flex items-center space-x-4">
                    {% if user.is_authenticated %}
                        <a href="{% url 'add_pigeon' %}" class="px-4 py-2 bg-[#D4AF37] text-black font-semibold rounded-lg hover:bg-[#C5A028] transition btn-luxury">
                            + –î–æ–±–∞–≤–∏—Ç—å
                        </a>
                        <a href="{% url 'my_pigeons' %}" class="text-gray-300 hover:text-[#D4AF37] transition hover-gold">
                            –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
                        </a>
                        <span class="text-gray-400">{{ user.username }}</span>
                        <form method="post" action="{% url 'logout' %}" class="inline">
                            {% csrf_token %}
                            <button type="submit" class="text-gray-300 hover:text-[#D4AF37] transition hover-gold">
                                –í—ã—Ö–æ–¥
                            </button>
                        </form>
                    {% else %}
                        <a href="{% url 'login' %}" class="text-gray-300 hover:text-[#D4AF37] transition hover-gold">
                            –í—Ö–æ–¥
                        </a>
                        <a href="{% url 'register' %}" class="px-4 py-2 border-2 border-[#D4AF37] text-[#D4AF37] font-semibold rounded-lg hover:bg-[#D4AF37] hover:text-black transition btn-luxury">
                            –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                        </a>
                    {% endif %}
                </div>
                
                <!-- Spacer for mobile -->
                <div class="lg:hidden w-6"></div>
            </div>
        </div>
    </nav>
    
    <!-- Messages -->
    {% if messages %}
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
        {% for message in messages %}
        <div class="p-4 rounded-lg mb-4 fade-in {% if message.tags == 'success' %}bg-green-900 border border-green-700{% elif message.tags == 'error' %}bg-red-900 border border-red-700{% else %}bg-blue-900 border border-blue-700{% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% block content %}
        {% endblock %}
    </main>
    
    <!-- Mobile Bottom Navigation (Mobile Only) -->
    <nav class="fixed bottom-0 left-0 right-0 bottom-nav z-nav lg:hidden">
        <div class="flex justify-around items-center py-3 px-2">
            <!-- Home -->
            <a href="{% url 'home' %}" class="bottom-nav-item flex flex-col items-center text-gray-400 hover:text-[#D4AF37] {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                <span class="text-xs mt-1">–ì–ª–∞–≤–Ω–∞—è</span>
            </a>
            
            <!-- Search -->
            <a href="{% url 'home' %}" class="bottom-nav-item flex flex-col items-center text-gray-400 hover:text-[#D4AF37]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <span class="text-xs mt-1">–ü–æ–∏—Å–∫</span>
            </a>
            
            <!-- Add (Center - Highlighted) -->
            <a href="{% url 'add_pigeon' %}" class="bottom-nav-item flex flex-col items-center -mt-4">
                <div class="w-14 h-14 rounded-full bg-[#D4AF37] flex items-center justify-center shadow-lg vip-glow">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                    </svg>
                </div>
                <span class="text-xs mt-1 text-[#D4AF37] font-semibold">–î–æ–±–∞–≤–∏—Ç—å</span>
            </a>
            
            <!-- Favorites -->
            <a href="{% url 'my_pigeons' %}" class="bottom-nav-item flex flex-col items-center text-gray-400 hover:text-[#D4AF37] {% if request.resolver_match.url_name == 'my_pigeons' %}active{% endif %}">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>
                <span class="text-xs mt-1">–ú–æ–∏</span>
            </a>
            
            <!-- Profile -->
            {% if user.is_authenticated %}
            <a href="{% url 'vip_payment' %}" class="bottom-nav-item flex flex-col items-center text-gray-400 hover:text-[#D4AF37]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-xs mt-1">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </a>
            {% else %}
            <a href="{% url 'login' %}" class="bottom-nav-item flex flex-col items-center text-gray-400 hover:text-[#D4AF37]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                </svg>
                <span class="text-xs mt-1">–í—Ö–æ–¥</span>
            </a>
            {% endif %}
        </div>
    </nav>
    
    <!-- Footer (Desktop Only) -->
    <footer class="hidden lg:block bg-[#1E1E1E] border-t border-gray-800 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center">
                <p class="text-gray-400">
                    &copy; 2025 <span class="gold-text font-semibold">–ì–æ–ª—É–±–ë–æ–∑–æ—Ä</span> - –ü—Ä–µ–º–∏—É–º —Ä—ã–Ω–æ–∫ –≥–æ–ª—É–±–µ–π –¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω–∞
                </p>
                <p class="text-gray-500 text-sm mt-2">
                    –î—É—à–∞–Ω–±–µ, –¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω
                </p>
            </div>
        </div>
    </footer>
    
    <!-- CSRF Token for AJAX -->
    {% csrf_token %}
    
    <!-- AOS (Animate On Scroll) -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- SimpleLightbox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.14.2/simple-lightbox.min.js"></script>
    
    <!-- Main JavaScript -->
    <script src="{% static 'js/main.js' %}"></script>
    
    <!-- Initialize Libraries -->
    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true,
            offset: 100
        });
        
        // Initialize SimpleLightbox
        if (document.querySelector('.lightbox')) {
            new SimpleLightbox('.lightbox', {
                overlayOpacity: 0.95,
                animationSpeed: 300,
                nav: true,
                close: true,
                showCounter: true
            });
        }
    </script>
    
</body>
</html>
